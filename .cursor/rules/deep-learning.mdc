---
alwaysApply: false
---
# 深度学习模块规则

## 核心文件
- [train.py](mdc:deep_learning_nowcasting/train.py) - 模型训练脚本
- [predict.py](mdc:deep_learning_nowcasting/predict.py) - 模型预测脚本
- [taasrad19.py](mdc:deep_learning_nowcasting/taasrad19.py) - 数据集加载器

## 模型架构
- **基础模型**: TrajGRU (Trajectory Gated Recurrent Unit)
- **输入**: 5帧雷达图像序列 (480×480像素)
- **输出**: 预测未来20帧的降水情况
- **框架**: MXNet 1.5.1

## 配置和训练
- [configurations/](mdc:deep_learning_nowcasting/configurations/) - 模型配置文件
- 支持多GPU训练 (需要16GB GPU内存或2个8GB GPU)
- 训练数据: 2010-2016年
- 测试数据: 2017-2019年

## 预测输出
预测结果保存为NPZ格式，包含：
- `*_in_*.npz` - 输入序列 (5帧)
- `*_pred_*.npz` - 预测序列 (20帧)  
- `*_gt_*.npz` - 真实值序列 (20帧)

## 关键模块
- [nowcasting/](mdc:deep_learning_nowcasting/nowcasting/) - 核心模型实现
- [operators/](mdc:deep_learning_nowcasting/nowcasting/operators/) - 神经网络操作符
- [helpers/](mdc:deep_learning_nowcasting/nowcasting/helpers/) - 辅助工具

## 使用示例
```bash
# 训练模型
python train.py --data_dir /path/to/data --save_dir /path/to/save --ctx gpu0,gpu1

# 生成预测
python predict.py --model_dir /path/to/model --data_dir /path/to/data --ctx cpu